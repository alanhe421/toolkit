<%- include layout/head.ejs %>
<body class="skin-blue">
<!-- Main Header -->
<%- include layout/header.ejs %>
<%- include layout/sidebar.ejs %>
<script src="/public/blueimp-file-upload/js/vendor/jquery.ui.widget.js" type="text/javascript"></script>
<script src="/public/blueimp-file-upload/js/jquery.iframe-transport.js" type="text/javascript"></script>
<script src="/public/blueimp-file-upload/js/jquery.fileupload.js" type="text/javascript"></script>

<div class="content-wrapper">
    <input id="fileupload" type="file" name="files[]" data-url="/upload" class="btn btn-primary">
    <div class="form-inline">
        <div class="form-group">
            <label for="exampleInputName2">宽度</label>
            <input type="text" class="form-control" id="width">
        </div>
        <div class="form-group">
            <label for="exampleInputEmail2">高度</label>
            <input type="text" class="form-control" id="height">
        </div>
        <button type="submit" class="btn btn-default" onclick="downloadFile()">下载</button>
    </div>
</div>
<script type="text/javascript">
    $(function () {
        $('#fileupload').fileupload({
            dataType: 'json',
            done: function (e, data) {
                alert('successful');
                $.each(data.result.files, function (index, file) {
                    $('<p/>').text(file.name).appendTo(document.body);
                });
            }
        });
    });
    function downloadFile() {
        let url = '/tools/crop?width=' + $('#width').val() + '&height=' + $('#height').val();
        location.href = url;
    }
</script>
</body>